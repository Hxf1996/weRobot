webpackJsonp([3],{161:function(t,o,e){"use strict";function a(t){e(179)}Object.defineProperty(o,"__esModule",{value:!0});var n=e(181),i=e(187),r=e(4),s=a,c=r(n.a,i.a,s,"data-v-d8398cca",null);o.default=c.exports},179:function(t,o,e){var a=e(180);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e(159)("1eeccdbc",a,!0)},180:function(t,o,e){o=t.exports=e(158)(!0),o.push([t.i,"h4[data-v-d8398cca]{margin-top:0;padding-top:22.4px;padding-top:1.4rem;margin-left:32px;margin-left:2rem;font-weight:400;color:#858787;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}.robot-list[data-v-d8398cca]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:scroll;padding-top:32px;padding-top:2rem;color:#585b60}.robot-list .card[data-v-d8398cca]{height:175px;width:30%;margin:0 auto;float:left;margin-left:2.5%;margin-bottom:16px;margin-bottom:1rem}.card-body>img[data-v-d8398cca]{width:80px;height:80px;border-radius:50%;float:left;margin-right:32px;margin-right:2rem}.card-body>p[data-v-d8398cca]{margin-top:9.6px;margin-top:.6rem}.card-body>button[data-v-d8398cca]{float:right}.login-robot[data-v-d8398cca]{text-align:center;font-size:25.6px;font-size:1.6rem;position:relative}.login-robot span[data-v-d8398cca]{position:absolute;top:50%;left:50%;margin-left:-80px;margin-left:-5rem;margin-top:-25.6px;margin-top:-1.6rem;color:#585b60}.help[data-v-d8398cca]{color:#585b60;font-size:12.8px;font-size:.8rem}","",{version:3,sources:["/Users/hxf/www/weRobot/src/page/RobotManage.vue"],names:[],mappings:"AAAA,oBAAoB,aAAa,mBAAmB,mBAAmB,iBAAiB,iBAAiB,gBAAgB,cAAc,mBAAmB,oBAAoB,WAAW,CAAC,6BAA6B,mBAAmB,oBAAoB,YAAY,kBAAkB,iBAAiB,iBAAiB,aAAa,CAAC,mCAAmC,aAAa,UAAU,cAAc,WAAW,iBAAiB,mBAAmB,kBAAkB,CAAC,gCAAgC,WAAW,YAAY,kBAAkB,WAAW,kBAAkB,iBAAiB,CAAC,8BAA8B,iBAAiB,gBAAgB,CAAC,mCAAmC,WAAW,CAAC,8BAA8B,kBAAkB,iBAAiB,iBAAiB,iBAAiB,CAAC,mCAAmC,kBAAkB,QAAQ,SAAS,kBAAkB,kBAAkB,mBAAmB,mBAAmB,aAAa,CAAC,uBAAuB,cAAc,iBAAiB,eAAe,CAAC",file:"RobotManage.vue",sourcesContent:["h4[data-v-d8398cca]{margin-top:0;padding-top:22.4px;padding-top:1.4rem;margin-left:32px;margin-left:2rem;font-weight:400;color:#858787;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}.robot-list[data-v-d8398cca]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:scroll;padding-top:32px;padding-top:2rem;color:#585b60}.robot-list .card[data-v-d8398cca]{height:175px;width:30%;margin:0 auto;float:left;margin-left:2.5%;margin-bottom:16px;margin-bottom:1rem}.card-body>img[data-v-d8398cca]{width:80px;height:80px;border-radius:50%;float:left;margin-right:32px;margin-right:2rem}.card-body>p[data-v-d8398cca]{margin-top:9.6px;margin-top:.6rem}.card-body>button[data-v-d8398cca]{float:right}.login-robot[data-v-d8398cca]{text-align:center;font-size:25.6px;font-size:1.6rem;position:relative}.login-robot span[data-v-d8398cca]{position:absolute;top:50%;left:50%;margin-left:-80px;margin-left:-5rem;margin-top:-25.6px;margin-top:-1.6rem;color:#585b60}.help[data-v-d8398cca]{color:#585b60;font-size:12.8px;font-size:.8rem}"],sourceRoot:""}])},181:function(t,o,e){"use strict";var a=e(12),n=e.n(a),i=e(13),r=e.n(i),s=e(5),c=e.n(s),d=e(8),l=e(182),u=e(62),p=e(21),b=e(63);o.a={name:"RobotManage",data:function(){return{focusRobotName:"",focusRobotId:"",loginRobotModal:!1,logoutRobotModal:!1,deleteRobotModal:!1,url:p.a,interval:""}},methods:c()({openLoginRobotModal:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r()(n.a.mark(function o(){return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:t.loginRobotModal=!0;case 1:case"end":return o.stop()}},o,t)}))()},closeLoginRobotModal:function(){this.loginRobotModal=!1},openLogoutRobotModal:function(){this.logoutRobotModal=!0},closeLogoutRobotModal:function(){this.logoutRobotModal=!1},logoutRobot:function(){var t=this;return r()(n.a.mark(function o(){return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t.loading({text:"正在断线"}),o.prev=1,o.next=4,b.a.logout({robotId:t.focusRobotId});case 4:return o.next=6,t.getRobotList();case 6:t.loaded(100),t.closeLogoutRobotModal(),o.next=14;break;case 10:o.prev=10,o.t0=o.catch(1),t.loading({text:o.t0}),t.loaded(1500);case 14:case"end":return o.stop()}},o,t,[[1,10]])}))()},openDeleteRobotModal:function(t){var o=t.nickname,e=t.id;this.focusRobotName=o,this.focusRobotId=e,this.deleteRobotModal=!0},closeDeleteRobotModal:function(){this.deleteRobotModal=!1},deleteRobot:function(){var t=this;return r()(n.a.mark(function o(){return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t.loading({text:"正在删除"}),o.prev=1,o.next=4,b.a.delRobot({robotId:t.focusRobotId});case 4:return o.next=6,t.getRobotList();case 6:t.loaded(100),t.focusRobotName="",t.focusRobotId="",t.closeDeleteRobotModal(),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(1),t.loading({text:o.t0}),t.loaded(1500);case 16:case"end":return o.stop()}},o,t,[[1,12]])}))()},toogleRobotStatu:function(t){var o=t.status,e=t.nickname,a=t.id,n=t.uin;switch(this.focusRobotName=e,this.focusRobotId=a,o){case 0:this.openLoginRobotModal(n);break;case 1:this.openLogoutRobotModal()}}},Object(d.b)("Robot",["getRobotList"]),Object(d.b)(["loaded"]),Object(d.c)(["loading"])),beforeRouteEnter:function(t,o,e){e(function(t){t.interval=setInterval(function(){t.getRobotList()},6e4)})},beforeRouteLeave:function(t,o,e){clearInterval(this.interval),e()},watch:{robotList:function(){0===this.robotList.length&&this.openLoginRobotModal()}},components:{LoginRobotModal:l.a,MessageBox:u.a},computed:c()({},Object(d.d)("User",["userToken"]),Object(d.d)("Robot",{robotList:"list"}))}},182:function(t,o,e){"use strict";function a(t){e(183)}var n=e(185),i=e(186),r=e(4),s=a,c=r(n.a,i.a,s,"data-v-d7d2c942",null);o.a=c.exports},183:function(t,o,e){var a=e(184);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e(159)("73e8fab1",a,!0)},184:function(t,o,e){o=t.exports=e(158)(!0),o.push([t.i,".qrcode[data-v-d7d2c942]{width:40%;margin:10px auto;border:1px solid #e7e8eb}.qrcode img[data-v-d7d2c942]{width:100%;height:auto}.body[data-v-d7d2c942]{padding-top:32px;padding-top:2rem;padding-bottom:64px;padding-bottom:4rem}.body>span[data-v-d7d2c942]{width:100%;text-align:center;display:block}","",{version:3,sources:["/Users/hxf/www/weRobot/src/components/LoginRobotModal.vue"],names:[],mappings:"AAAA,yBAAyB,UAAU,iBAAiB,wBAAwB,CAAC,6BAA6B,WAAW,WAAW,CAAC,uBAAuB,iBAAiB,iBAAiB,oBAAoB,mBAAmB,CAAC,4BAA4B,WAAW,kBAAkB,aAAa,CAAC",file:"LoginRobotModal.vue",sourcesContent:[".qrcode[data-v-d7d2c942]{width:40%;margin:10px auto;border:1px solid #e7e8eb}.qrcode img[data-v-d7d2c942]{width:100%;height:auto}.body[data-v-d7d2c942]{padding-top:32px;padding-top:2rem;padding-bottom:64px;padding-bottom:4rem}.body>span[data-v-d7d2c942]{width:100%;text-align:center;display:block}"],sourceRoot:""}])},185:function(t,o,e){"use strict";var a=e(12),n=e.n(a),i=e(13),r=e.n(i),s=e(5),c=e.n(s),d=e(8),l=e(36),u=e(63);o.a={name:"LoginRobotModal",props:["name","active"],data:function(){return{qrCodeUrl:"",refreshInterval:"",time:"",show:!1,timestamp:"",stopAllTime:""}},methods:c()({open:function(){var t=this;return r()(n.a.mark(function o(){var e,a,i;return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t.show=t.active,o.prev=1,t.timestamp=(new Date).getTime(),o.next=5,u.a.getLoginQrcode({userId:t.userToken});case 5:return e=o.sent,a=e.uuid,i=e.qrcode,t.setUUId(a),t.qrCodeUrl=i,o.next=12,t.isScan();case 12:o.next=18;break;case 14:o.prev=14,o.t0=o.catch(1),t.loading({text:o.t0}),t.loaded(1500);case 18:case"end":return o.stop()}},o,t,[[1,14]])}))()},isScan:function(){var t=this;return r()(n.a.mark(function o(){var e;return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!((new Date).getTime()-t.timestamp>3e5)){o.next=4;break}return t.loading({text:"超时，请刷新"}),t.loaded(1500),o.abrupt("return",!1);case 4:return e=t.timestamp,o.prev=5,o.next=8,u.a.isScan({userId:t.userToken,uuid:t.uuid});case 8:return o.next=10,t.isLogin();case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(5),"等待扫码"===o.t0?t.show&&e===t.timestamp&&(t.time=setTimeout(r()(n.a.mark(function o(){return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.isScan();case 2:case"end":return o.stop()}},o,t)})),1e3)):(t.init(),t.loading({text:o.t0}),t.loaded(1500));case 15:return o.abrupt("return",!0);case 16:case"end":return o.stop()}},o,t,[[5,12]])}))()},isLogin:function(){var t=this;return r()(n.a.mark(function o(){var e,a,i,s;return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!((new Date).getTime()-t.timestamp>3e5)){o.next=4;break}return t.loading({text:"超时，请刷新"}),t.loaded(1500),o.abrupt("return",!1);case 4:return e=t.timestamp,o.prev=5,o.next=8,u.a.isLogin({userId:t.userToken,uuid:t.uuid});case 8:return a=o.sent,i=a.uin,s=a.id,clearInterval(t.refreshInterval),o.next=14,t.initRobot({uin:i,robotId:s});case 14:o.next=19;break;case 16:o.prev=16,o.t0=o.catch(5),"等待确认"===o.t0?t.show&&e===t.timestamp&&(t.time=setTimeout(r()(n.a.mark(function o(){return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.isLogin();case 2:case"end":return o.stop()}},o,t)})),1e3)):(t.init(),t.loading({text:o.t0}),t.loaded(1500));case 19:return o.abrupt("return",!0);case 20:case"end":return o.stop()}},o,t,[[5,16]])}))()},initRobot:function(t){var o=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o.close(),e.next=4,u.a.init(t);case 4:o.$emit("successLogin"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),o.loading({text:e.t0}),o.loaded(1500);case 11:case"end":return e.stop()}},e,o,[[0,7]])}))()},close:function(){this.init(),this.show=!1,this.closeBackDrop(),this.$emit("close")},init:function(){clearTimeout(this.time),clearInterval(this.refreshInterval),this.time="",this.refreshInterval=""}},Object(d.c)(["closeBackDrop","openBackDrop","loading"]),Object(d.c)("User",["setUUId"]),Object(d.b)(["loaded"])),components:{Modal:l.a},watch:{active:function(t){t&&(this.openBackDrop(),this.open())}},computed:c()({},Object(d.d)("User",["userToken","uuid"]))}},186:function(t,o,e){"use strict";var a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("modal",{attrs:{active:t.show},on:{toogle:t.close}},[e("div",{staticClass:"modal-header"},[e("h5",[t._v(t._s(t.name?"机器人连接":"机器人创建"))]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:t.close}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"body"},[e("div",{staticClass:"qrcode"},[e("img",{attrs:{src:t.qrCodeUrl,alt:"登陆二维码"}})]),t._v(" "),e("span",[t._v(t._s(t.name?"用机器人"+t.name+"的微信账号扫码重新登录":"微信扫码并确认登陆，完成机器人创建"))])])])},n=[],i={render:a,staticRenderFns:n};o.a=i},187:function(t,o,e){"use strict";var a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"robot-manage"}},[e("h4",[t._v("机器人管理")]),t._v(" "),e("div",{staticClass:"robot-list"},[t._l(t.robotList,function(o){return e("div",{key:o.id,staticClass:"card"},[e("div",{staticClass:"card-body"},[e("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){t.openDeleteRobotModal(o)}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),t._v(" "),e("img",{attrs:{src:o.headImgUrl,alt:"头像"}}),t._v(" "),e("p",{staticClass:"card-text"},[t._v("机器人："+t._s(o.nickname))]),t._v(" "),e("p",{staticClass:"card-text"},[t._v("状态："+t._s(o.status?"在线":"离线"))]),t._v(" "),e("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.toogleRobotStatu(o)}}},[t._v(t._s(o.status?"手动掉线":"重新连接"))])])])}),t._v(" "),0===t.robotList.length?e("div",{staticClass:"card login-robot",on:{click:t.openLoginRobotModal}},[t._m(0)]):t._e()],2),t._v(" "),t._m(1),t._v(" "),e("login-robot-modal",{attrs:{active:t.loginRobotModal,name:t.focusRobotName},on:{close:t.closeLoginRobotModal,successLogin:t.getRobotList}}),t._v(" "),e("message-box",{attrs:{active:t.logoutRobotModal,title:"手动掉线"},on:{close:t.closeLogoutRobotModal,submit:t.logoutRobot}},[e("span",[t._v("你确定要掉线"),e("br"),t._v('机器人"'+t._s(t.focusRobotName)+'"吗？')])]),t._v(" "),e("message-box",{attrs:{active:t.deleteRobotModal,title:""},on:{close:t.closeDeleteRobotModal,submit:t.deleteRobot}},[e("span",[t._v("你确定要删除"),e("br"),t._v('机器人"'+t._s(t.focusRobotName)+'"吗？')])])],1)},n=[function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"card-body"},[e("span",{staticClass:"card-title"},[t._v("+ 创建机器人")])])},function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("ol",{staticClass:"help"},[t._v("使用帮助：\n        "),e("li",[t._v("如果尝试多次登录失败，请登录web微信（http://wx.qq.com），检查是否可以正常登录")]),t._v(" "),e("li",[t._v("微信机器人登录后，请尽量避使用PC客户端登录或网页端登录微信，否则会导致机器人服务不稳定")])])}],i={render:a,staticRenderFns:n};o.a=i}});
//# sourceMappingURL=3.dd22dc30a8c0c12f40e3.js.map