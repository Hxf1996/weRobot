(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"2YoC":function(e,t,a){"use strict";var s=a("qcRe");a.n(s).a},"3xfJ":function(e,t,a){"use strict";a.r(t);var s=a("rmO2"),r=a.n(s),o=a("9cTa"),n=a.n(o),i=a("QdXe"),m=a.n(i),l=a("lOrp"),u=a("Otcf"),c=function(e){return new Promise(function(t,a){u.b.post("/red/redEnvelopesConfig",e).then(function(e){e.data.status?t(e.data.message):a(new Error(e.data.message))}).catch(function(){a(new Error("网络不稳定请刷新重试！"))})})},d=function(e){return new Promise(function(t,a){u.b.get("/red/getEnvelopesConfig",{params:e}).then(function(e){e.data.status?t(e.data.entry):a(new Error(e.data.message))}).catch(function(){a(new Error("网络不稳定请刷新重试！"))})})},p=function(e){return new Promise(function(t,a){u.b.get("/red/redEnvelopesClose",{params:e}).then(function(e){e.data.status?t(e.data.message):a(new Error(e.data.message))}).catch(function(){a(new Error("网络不稳定请刷新重试！"))})})},v={name:"RedPacket",created:function(){this.init(),this.getConfig()},data:function(){return{validate:{budget:function(e){if(e.budget<1)throw new Error("预算不得小于一块")},redEnvelopesNums:function(e){var t=e.budget,a=e.redEnvelopesNums;if(a<1)throw new Error("数量不得小于一个");if(t/100<a)throw new Error("单个红包不得小于一块")},amountRandomLower:function(e){var t=e.amountRandomLower,a=e.budget;if(1===e.redEnvelopesType)return!1;if(t<1)throw new Error("过小");if(t>a)throw new Error("过大");return!0},amountRandomUpper:function(e){var t=e.budget,a=e.amountRandomUpper,s=e.amountRandomLower;if(1===e.redEnvelopesType)return!1;if(a<1)throw new Error("过小");if(a<s)throw new Error("过小");if(a>t)throw new Error("过小");return!0},timesLimitUpper:function(e){var t=e.timesLimitUpper;if(!e.timesLimit)return!1;if(t<1)throw new Error("限制不得小于一次");return!0}},formData:{status:0,budget:"",redEnvelopesNums:"",redEnvelopesType:1,amountRandomUpper:"",amountRandomLower:"",pageDoc1:"",pageDoc2:"",pageDoc3:"",timesLimit:!1,timesLimitUpper:""},readOnly:!1}},methods:m()({getConfig:function(){var e=n()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading({text:"正在加载"}),e.prev=1,e.next=4,d({groupId:this.$route.params.id});case 4:(t=e.sent)&&(this.readOnly=!0,this.formData=t),this.loaded(100),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),this.loading({text:e.t0.message}),this.loaded(1500);case 13:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}(),init:function(){this.formData={status:0,budget:"",redEnvelopesNums:"",redEnvelopesType:1,amountRandomUpper:"",amountRandomLower:"",pageDoc1:this.userInfo.realName,pageDoc2:"送您一个进群红包",pageDoc3:"邀请朋友进群，也可以领取红包哦",timesLimit:!1,timesLimitUpper:""},this.readOnly=!1},submit:function(){this.readOnly?this.closePacket():this.openPacket()},openPacket:function(){var e=n()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading({text:"正在保存"}),e.prev=1,e.next=4,c(m()({},this.formData,{userId:this.userId,groupId:this.$route.params.id}));case 4:return t=e.sent,this.loading({text:t}),e.next=8,this.getConfig();case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),this.loading({text:e.t0.message}),this.loaded(1500);case 14:case"end":return e.stop()}},e,this,[[1,10]])}));return function(){return e.apply(this,arguments)}}(),closePacket:function(){var e=n()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading({text:"正在关闭"}),e.prev=1,e.next=4,p({groupId:this.$route.params.id});case 4:return t=e.sent,this.loading({text:t}),this.init(),e.next=9,this.getConfig();case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),this.loading({text:e.t0.message}),this.loaded(1500);case 15:case"end":return e.stop()}},e,this,[[1,11]])}));return function(){return e.apply(this,arguments)}}()},Object(l.c)(["loading"]),Object(l.b)(["loaded"])),watch:{$route:function(){var e=n()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.init(),e.next=3,this.getConfig();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},computed:m()({status:{get:function(){return!!this.formData.status},set:function(e){this.formData.status=e?1:0}},isSave:function(){return(!this.formData.status||!this.readOnly)&&(""!==this.formData.budget&&""!==this.formData.redEnvelopesNums&&(""!==this.formData.pageDoc1&&""!==this.formData.pageDoc2&&""!==this.formData.pageDoc3&&((2!==this.formData.redEnvelopesType||""!==this.formData.amountRandomLower&&""!==this.formData.amountRandomUpper)&&(!this.formData.timesLimit||""!==this.formData.timesLimitUpper))))},statusStr:function(){return{1:"正在进行",2:"已领完",3:"已关闭"}[this.formData.status]},budget:{get:function(){return this.formData.budget?this.formData.budget/100:""},set:function(e){this.formData.budget=100*e}},amountRandomUpper:{get:function(){return this.formData.amountRandomUpper?this.formData.amountRandomUpper/100:""},set:function(e){this.formData.amountRandomUpper=100*e}},amountRandomLower:{get:function(){return this.formData.amountRandomLower?this.formData.amountRandomLower/100:""},set:function(e){this.formData.amountRandomLower=100*e}}},Object(l.d)("User",{userId:"userToken",userInfo:"userInfo"}))},f=(a("2YoC"),a("ertO")),h=Object(f.a)(v,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{directives:[{name:"validate",rawName:"v-validate.formData",value:e.validate,expression:"validate",modifiers:{formData:!0}}],attrs:{id:"red-package"},on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"status"}},[e._v("功能状态   ")]),e._v(" "),a("div",{staticClass:"col-sm-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.status,expression:"status"}],staticClass:"toggle-button",attrs:{type:"checkbox",name:"status",id:"status"},domProps:{checked:Array.isArray(e.status)?e._i(e.status,null)>-1:e.status},on:{change:function(t){var a=e.status,s=t.target,r=!!s.checked;if(Array.isArray(a)){var o=e._i(a,null);s.checked?o<0&&(e.status=a.concat([null])):o>-1&&(e.status=a.slice(0,o).concat(a.slice(o+1)))}else e.status=r}}})]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.readOnly&&e.status,expression:"readOnly && status"}],staticClass:"inline-margin"},[e._v("红包状态："+e._s(e.statusStr))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"budget"}},[e._v("群内红包预算 ")]),e._v(" "),a("div",{staticClass:"col-sm-2"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.budget,expression:"budget",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",name:"budget",id:"budget",placeholder:"元",readonly:e.readOnly},domProps:{value:e.budget},on:{input:function(t){t.target.composing||(e.budget=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.readOnly,expression:"readOnly"}],staticClass:"inline-margin"},[e._v("剩余金额："+e._s(e.formData.residueAmount/100)+"元")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"num"}},[e._v("红包发放个数 ")]),e._v(" "),a("div",{staticClass:"col-sm-2"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.formData.redEnvelopesNums,expression:"formData.redEnvelopesNums",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",name:"redEnvelopesNums",id:"num",placeholder:"个",readonly:e.readOnly},domProps:{value:e.formData.redEnvelopesNums},on:{input:function(t){t.target.composing||e.$set(e.formData,"redEnvelopesNums",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.readOnly,expression:"readOnly"}],staticClass:"inline-margin"},[e._v("剩余数量："+e._s(e.formData.residueNums)+"个")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row money"},[a("label",{staticClass:"col-sm-2 col-form-label"},[e._v("拉新红包金额 ")]),e._v(" "),a("div",{staticClass:"col-sm-8"},[a("div",{staticClass:"form-check"},[a("label",{staticClass:"form-check-label",attrs:{for:"fix"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.redEnvelopesType,expression:"formData.redEnvelopesType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"type",id:"fix",disabled:e.readOnly},domProps:{value:1,checked:e._q(e.formData.redEnvelopesType,1)},on:{change:function(t){e.$set(e.formData,"redEnvelopesType",1)}}}),e._v("固定红包\n                ")])]),e._v(" "),a("div",{staticClass:"form-row align-items-center"},[a("div",{staticClass:"col-auto"},[a("label",{staticClass:"form-check-label",attrs:{for:"random"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.redEnvelopesType,expression:"formData.redEnvelopesType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"type",id:"random",disabled:e.readOnly},domProps:{value:2,checked:e._q(e.formData.redEnvelopesType,2)},on:{change:function(t){e.$set(e.formData,"redEnvelopesType",2)}}}),e._v("随机红包\n                    ")])]),e._v(" "),a("div",{staticClass:"col-auto"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.amountRandomLower,expression:"amountRandomLower",modifiers:{number:!0}},{name:"show",rawName:"v-show",value:2===e.formData.redEnvelopesType,expression:"formData.redEnvelopesType === 2"}],staticClass:"form-control redRandom",attrs:{type:"number",name:"amountRandomLower",readonly:e.readOnly},domProps:{value:e.amountRandomLower},on:{input:function(t){t.target.composing||(e.amountRandomLower=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:2===e.formData.redEnvelopesType,expression:"formData.redEnvelopesType === 2"}]},[e._v("-")]),e._v(" "),a("div",{staticClass:"col-auto"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.amountRandomUpper,expression:"amountRandomUpper",modifiers:{number:!0}},{name:"show",rawName:"v-show",value:2===e.formData.redEnvelopesType,expression:"formData.redEnvelopesType === 2"}],staticClass:"form-control redRandom",attrs:{type:"number",name:"amountRandomUpper",readonly:e.readOnly},domProps:{value:e.amountRandomUpper},on:{input:function(t){t.target.composing||(e.amountRandomUpper=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})])])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row money"},[a("label",{staticClass:"col-sm-2 col-form-label"},[e._v("单人邀请奖励数")]),e._v(" "),a("div",{staticClass:"col-sm-8"},[a("div",{staticClass:"form-check"},[a("label",{staticClass:"form-check-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.timesLimit,expression:"formData.timesLimit"}],staticClass:"form-check-input",attrs:{type:"radio",name:"limit",disabled:e.readOnly},domProps:{value:!1,checked:e._q(e.formData.timesLimit,!1)},on:{change:function(t){e.$set(e.formData,"timesLimit",!1)}}}),e._v("不限\n                ")])]),e._v(" "),a("div",{staticClass:"form-row align-items-center"},[a("div",{staticClass:"col-auto"},[a("label",{staticClass:"form-check-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.timesLimit,expression:"formData.timesLimit"}],staticClass:"form-check-input",attrs:{type:"radio",name:"limit",disabled:e.readOnly},domProps:{value:!0,checked:e._q(e.formData.timesLimit,!0)},on:{change:function(t){e.$set(e.formData,"timesLimit",!0)}}}),e._v("限制次数\n                    ")])]),e._v(" "),a("div",{staticClass:"col-auto"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.formData.timesLimitUpper,expression:"formData.timesLimitUpper",modifiers:{number:!0}},{name:"show",rawName:"v-show",value:e.formData.timesLimit,expression:"formData.timesLimit"}],staticClass:"form-control",staticStyle:{width:"80px"},attrs:{type:"number",placeholder:"次",name:"timesLimitUpper",readonly:e.readOnly},domProps:{value:e.formData.timesLimitUpper},on:{input:function(t){t.target.composing||e.$set(e.formData,"timesLimitUpper",e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),a("small",{staticClass:"form-text text-muted"},[e._v("单人邀请他人入群，奖励到达上限后，不再发放")])])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"header-text"}},[e._v("红包页文案  ")]),e._v(" "),a("div",{staticClass:"col-sm-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.pageDoc1,expression:"formData.pageDoc1"}],staticClass:"form-control",attrs:{type:"text",name:"pageDoc1",id:"header-text",placeholder:"文案1",readonly:e.readOnly,maxlength:"14"},domProps:{value:e.formData.pageDoc1},on:{input:function(t){t.target.composing||e.$set(e.formData,"pageDoc1",t.target.value)}}})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"bottom-text"}}),e._v(" "),a("div",{staticClass:"col-sm-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.pageDoc2,expression:"formData.pageDoc2"}],staticClass:"form-control",attrs:{type:"text",name:"pageDoc2",id:"bottom-text",placeholder:"文案2",readonly:e.readOnly,maxlength:"18"},domProps:{value:e.formData.pageDoc2},on:{input:function(t){t.target.composing||e.$set(e.formData,"pageDoc2",t.target.value)}}})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"bottom-text"}}),e._v(" "),a("div",{staticClass:"col-sm-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.pageDoc3,expression:"formData.pageDoc3"}],staticClass:"form-control",attrs:{type:"text",name:"pageDoc2",id:"bottom-text",placeholder:"文案3",readonly:e.readOnly,maxlength:"22"},domProps:{value:e.formData.pageDoc3},on:{input:function(t){t.target.composing||e.$set(e.formData,"pageDoc3",t.target.value)}}})])]),e._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"status"}],staticClass:"preview",attrs:{src:"http://cdn.elephtribe.com/assets/voice/09/28/n_1506589801161_3931.png",alt:"红包预览图"}}),e._v(" "),a("footer",[a("button",{staticClass:"save",attrs:{type:"submit",disabled:!e.isSave}},[e._v("保存")])])])},[],!1,null,"026112f0",null);h.options.__file="RedPacket.vue";t.default=h.exports},qcRe:function(e,t,a){}}]);
//# sourceMappingURL=11.38969b56.js.map